import{A as U,I as O,cx as R,D as lt,az as Z,aK as tt,G as q,aU as st,N as F,L as gt,aL as _,aB as ct,b as ft,ae as G,f as K,w as H,U as ut,a8 as J,cy as ht,E as dt,a9 as xt,cz as pt,aq as vt,cA as X,cB as et,cC as W,ap as mt}from"./index-CfHuJ7al.js";import{e as yt,n as wt}from"./labelLayoutHelper-BXY3hQ5I.js";var M=Math.PI,z=function(){function e(t,r){this.group=new U,this.opt=r,this.axisModel=t,O(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var u=new U({x:r.position[0],y:r.position[1],rotation:r.rotation});u.updateTransform(),this._transformGroup=u}return e.prototype.hasBuilder=function(t){return!!Y[t]},e.prototype.add=function(t){Y[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,u){var f,h,g=et(r-t);return W(g)?(h=u>0?"top":"bottom",f="center"):W(g-M)?(h=u>0?"bottom":"top",f="center"):(h="middle",f=g>0&&g<M?u>0?"right":"left":u>0?"left":"right"),{rotation:g,textAlign:f,textVerticalAlign:h}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),Y={axisLine:function(e,t,r,u){var f=t.get(["axisLine","show"]);if(f==="auto"&&e.handleAutoShown&&(f=e.handleAutoShown("axisLine")),f){var h=t.axis.getExtent(),g=u.transform,n=[h[0],0],i=[h[1],0],a=n[0]>i[0];g&&(R(n,n,g),R(i,i,g));var l=lt({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),o=new Z({shape:{x1:n[0],y1:n[1],x2:i[0],y2:i[1]},style:l,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});tt(o.shape,o.style.lineWidth),o.anid="line",r.add(o);var c=t.get(["axisLine","symbol"]);if(c!=null){var s=t.get(["axisLine","symbolSize"]);q(c)&&(c=[c,c]),(q(s)||mt(s))&&(s=[s,s]);var p=st(t.get(["axisLine","symbolOffset"])||0,s),y=s[0],v=s[1];F([{rotate:e.rotation+Math.PI/2,offset:p[0],r:0},{rotate:e.rotation-Math.PI/2,offset:p[1],r:Math.sqrt((n[0]-i[0])*(n[0]-i[0])+(n[1]-i[1])*(n[1]-i[1]))}],function(d,w){if(c[w]!=="none"&&c[w]!=null){var x=gt(c[w],-y/2,-v/2,y,v,l.stroke,!0),S=d.r+d.offset,I=a?i:n;x.attr({rotation:d.rotate,x:I[0]+S*Math.cos(e.rotation),y:I[1]-S*Math.sin(e.rotation),silent:!0,z2:11}),r.add(x)}})}}},axisTickLabel:function(e,t,r,u){var f=function(n,i,a,l){var o=a.axis,c=a.getModel("axisTick"),s=c.get("show");if(s==="auto"&&l.handleAutoShown&&(s=l.handleAutoShown("axisTick")),!(!s||o.scale.isBlank())){for(var p=c.getModel("lineStyle"),y=l.tickDirection*c.get("length"),v=Q(o.getTicksCoords(),i.transform,y,O(p.getLineStyle(),{stroke:a.get(["axisLine","lineStyle","color"])}),"ticks"),d=0;d<v.length;d++)n.add(v[d]);return v}}(r,u,t,e),h=function(n,i,a,l){var o=a.axis,c=_(l.axisLabelShow,a.get(["axisLabel","show"]));if(!(!c||o.scale.isBlank())){var s=a.getModel("axisLabel"),p=s.get("margin"),y=o.getViewLabels(),v=(_(l.labelRotate,s.get("rotate"))||0)*M/180,d=z.innerTextLayout(l.rotation,v,l.labelDirection),w=a.getCategories&&a.getCategories(!0),x=[],S=z.isLabelSilent(a),I=a.get("triggerEvent");return F(y,function(T,k){var b=o.scale.type==="ordinal"?o.scale.getRawOrdinalNumber(T.tickValue):T.tickValue,C=T.formattedLabel,D=T.rawLabel,m=s;if(w&&w[b]){var E=w[b];ct(E)&&E.textStyle&&(m=new ft(E.textStyle,s,a.ecModel))}var A=m.getTextColor()||a.get(["axisLine","lineStyle","color"]),at=o.dataToCoord(b),N=m.getShallow("align",!0)||d.textAlign,nt=G(m.getShallow("alignMinLabel",!0),N),it=G(m.getShallow("alignMaxLabel",!0),N),P=m.getShallow("verticalAlign",!0)||m.getShallow("baseline",!0)||d.textVerticalAlign,ot=G(m.getShallow("verticalAlignMinLabel",!0),P),rt=G(m.getShallow("verticalAlignMaxLabel",!0),P),B=new K({x:at,y:l.labelOffset+l.labelDirection*p,rotation:d.rotation,silent:S,z2:10+(T.level||0),style:H(m,{text:C,align:k===0?nt:k===y.length-1?it:N,verticalAlign:k===0?ot:k===y.length-1?rt:P,fill:ut(A)?A(o.type==="category"?D:o.type==="value"?b+"":b,k):A})});if(B.anid="label_"+b,I){var V=z.makeAxisEventDataBase(a);V.targetType="axisLabel",V.value=D,V.tickIndex=k,o.type==="category"&&(V.dataIndex=b),J(B).eventData=V}i.add(B),B.updateTransform(),x.push(B),n.add(B),B.decomposeTransform()}),x}}(r,u,t,e);if(function(n,i,a){if(!ht(n.axis)){var l=n.get(["axisLabel","showMinLabel"]),o=n.get(["axisLabel","showMaxLabel"]);i=i||[],a=a||[];var c=i[0],s=i[1],p=i[i.length-1],y=i[i.length-2],v=a[0],d=a[1],w=a[a.length-1],x=a[a.length-2];l===!1?(L(c),L(v)):$(c,s)&&(l?(L(s),L(d)):(L(c),L(v))),o===!1?(L(p),L(w)):$(y,p)&&(o?(L(y),L(x)):(L(p),L(w)))}}(t,h,f),function(n,i,a,l){var o=a.axis,c=a.getModel("minorTick");if(!(!c.get("show")||o.scale.isBlank())){var s=o.getMinorTicksCoords();if(s.length)for(var p=c.getModel("lineStyle"),y=l*c.get("length"),v=O(p.getLineStyle(),O(a.getModel("axisTick").getLineStyle(),{stroke:a.get(["axisLine","lineStyle","color"])})),d=0;d<s.length;d++)for(var w=Q(s[d],i.transform,y,v,"minorticks_"+d),x=0;x<w.length;x++)n.add(w[x])}}(r,u,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var g=yt(dt(h,function(n){return{label:n,priority:n.z2,defaultAttr:{ignore:n.ignore}}}));wt(g)}},axisName:function(e,t,r,u){var f=_(e.axisName,t.get("name"));if(f){var h,g,n=t.get("nameLocation"),i=e.nameDirection,a=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,o=t.axis.getExtent(),c=o[0]>o[1]?-1:1,s=[n==="start"?o[0]-c*l:n==="end"?o[1]+c*l:(o[0]+o[1])/2,j(n)?e.labelOffset+i*l:0],p=t.get("nameRotate");p!=null&&(p=p*M/180),j(n)?h=z.innerTextLayout(e.rotation,p??e.rotation,i):(h=function(I,T,k,b){var C,D,m=et(k-I),E=b[0]>b[1],A=T==="start"&&!E||T!=="start"&&E;return W(m-M/2)?(D=A?"bottom":"top",C="center"):W(m-1.5*M)?(D=A?"top":"bottom",C="center"):(D="middle",C=m<1.5*M&&m>M/2?A?"left":"right":A?"right":"left"),{rotation:m,textAlign:C,textVerticalAlign:D}}(e.rotation,n,p||0,o),(g=e.axisNameAvailableWidth)!=null&&(g=Math.abs(g/Math.sin(h.rotation)),!isFinite(g)&&(g=null)));var y=a.getFont(),v=t.get("nameTruncate",!0)||{},d=v.ellipsis,w=_(e.nameTruncateMaxWidth,v.maxWidth,g),x=new K({x:s[0],y:s[1],rotation:h.rotation,silent:z.isLabelSilent(t),style:H(a,{text:f,font:y,overflow:"truncate",width:w,ellipsis:d,fill:a.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:a.get("align")||h.textAlign,verticalAlign:a.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(xt({el:x,componentModel:t,itemName:f}),x.__fullText=f,x.anid="name",t.get("triggerEvent")){var S=z.makeAxisEventDataBase(t);S.targetType="axisName",S.name=f,J(x).eventData=S}u.add(x),x.updateTransform(),r.add(x),x.decomposeTransform()}}};function L(e){e&&(e.ignore=!0)}function $(e,t){var r=e&&e.getBoundingRect().clone(),u=t&&t.getBoundingRect().clone();if(r&&u){var f=pt([]);return vt(f,f,-e.rotation),r.applyTransform(X([],f,e.getLocalTransform())),u.applyTransform(X([],f,t.getLocalTransform())),r.intersect(u)}}function j(e){return e==="middle"||e==="center"}function Q(e,t,r,u,f){for(var h=[],g=[],n=[],i=0;i<e.length;i++){var a=e[i].coord;g[0]=a,g[1]=0,n[0]=a,n[1]=r,t&&(R(g,g,t),R(n,n,t));var l=new Z({shape:{x1:g[0],y1:g[1],x2:n[0],y2:n[1]},style:u,z2:2,autoBatch:!0,silent:!0});tt(l.shape,l.style.lineWidth),l.anid=f+"_"+e[i].tickValue,h.push(l)}return h}export{z as C};
