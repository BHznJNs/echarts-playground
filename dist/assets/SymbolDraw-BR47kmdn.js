import{A as I,ab as _,bK as E,bR as G,aB as M}from"./index-B7CpzWKR.js";import{b as P}from"./Symbol-BYwjqfoC.js";function g(i,t,e,o){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(o.isIgnore&&o.isIgnore(e))&&!(o.clipShape&&!o.clipShape.contain(t[0],t[1]))&&i.getItemVisual(e,"symbol")!=="none"}function v(i){return i==null||M(i)||(i={isIgnore:i}),i||{}}function S(i){var t=i.hostModel,e=t.getModel("emphasis");return{emphasisItemStyle:e.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:e.get("focus"),blurScope:e.get("blurScope"),emphasisDisabled:e.get("disabled"),hoverScale:e.get("scale"),labelStatesModels:G(t),cursorStyle:t.get("cursor")}}var x=function(){function i(t){this.group=new I,this._SymbolCtor=t||P}return i.prototype.updateData=function(t,e){this._progressiveEls=null,e=v(e);var o=this.group,n=t.hostModel,s=this._data,c=this._SymbolCtor,l=e.disableAnimation,p=S(t),h={disableAnimation:l},d=e.getSymbolPoint||function(a){return t.getItemLayout(a)};s||o.removeAll(),t.diff(s).add(function(a){var u=d(a);if(g(t,u,a,e)){var r=new c(t,a,p,h);r.setPosition(u),t.setItemGraphicEl(a,r),o.add(r)}}).update(function(a,u){var r=s.getItemGraphicEl(u),m=d(a);if(g(t,m,a,e)){var b=t.getItemVisual(a,"symbol")||"circle",y=r&&r.getSymbolType&&r.getSymbolType();if(!r||y&&y!==b)o.remove(r),(r=new c(t,a,p,h)).setPosition(m);else{r.updateData(t,a,p,h);var f={x:m[0],y:m[1]};l?r.attr(f):_(r,f,n)}o.add(r),t.setItemGraphicEl(a,r)}else o.remove(r)}).remove(function(a){var u=s.getItemGraphicEl(a);u&&u.fadeOut(function(){o.remove(u)},n)}).execute(),this._getSymbolPoint=d,this._data=t},i.prototype.updateLayout=function(){var t=this,e=this._data;e&&e.eachItemGraphicEl(function(o,n){var s=t._getSymbolPoint(n);o.setPosition(s),o.markRedraw()})},i.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=S(t),this._data=null,this.group.removeAll()},i.prototype.incrementalUpdate=function(t,e,o){function n(p){p.isGroup||(p.incremental=!0,p.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],o=v(o);for(var s=t.start;s<t.end;s++){var c=e.getItemLayout(s);if(g(e,c,s,o)){var l=new this._SymbolCtor(e,s,this._seriesScope);l.traverse(n),l.setPosition(c),this.group.add(l),e.setItemGraphicEl(s,l),this._progressiveEls.push(l)}}},i.prototype.eachRendered=function(t){E(this._progressiveEls||this.group,t)},i.prototype.remove=function(t){var e=this.group,o=this._data;o&&t?o.eachItemGraphicEl(function(n){n.fadeOut(function(){e.remove(n)},o.hostModel)}):e.removeAll()},i}();export{x as u};
