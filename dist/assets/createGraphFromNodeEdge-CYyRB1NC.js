import{g as l,at as _,aL as m,a6 as N,bI as j,df as k,O as L,d8 as V,aN as D,ap as M}from"./index-CfHuJ7al.js";import{d as A}from"./linkSeriesData-D22oIY9d.js";function p(a){return"_EC_"+a}var B=function(){function a(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return a.prototype.isDirected=function(){return this._directed},a.prototype.addNode=function(t,e){t=t==null?""+e:""+t;var n=this._nodesMap;if(!n[p(t)]){var o=new f(t,e);return o.hostGraph=this,this.nodes.push(o),n[p(t)]=o,o}},a.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},a.prototype.getNodeById=function(t){return this._nodesMap[p(t)]},a.prototype.addEdge=function(t,e,n){var o=this._nodesMap,d=this._edgesMap;if(M(t)&&(t=this.nodes[t]),M(e)&&(e=this.nodes[e]),t instanceof f||(t=o[p(t)]),e instanceof f||(e=o[p(e)]),t&&e){var s=t.id+"-"+e.id,r=new R(t,e,n);return r.hostGraph=this,this._directed&&(t.outEdges.push(r),e.inEdges.push(r)),t.edges.push(r),t!==e&&e.edges.push(r),this.edges.push(r),d[s]=r,r}},a.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},a.prototype.getEdge=function(t,e){t instanceof f&&(t=t.id),e instanceof f&&(e=e.id);var n=this._edgesMap;return this._directed?n[t+"-"+e]:n[t+"-"+e]||n[e+"-"+t]},a.prototype.eachNode=function(t,e){for(var n=this.nodes,o=n.length,d=0;d<o;d++)n[d].dataIndex>=0&&t.call(e,n[d],d)},a.prototype.eachEdge=function(t,e){for(var n=this.edges,o=n.length,d=0;d<o;d++)n[d].dataIndex>=0&&n[d].node1.dataIndex>=0&&n[d].node2.dataIndex>=0&&t.call(e,n[d],d)},a.prototype.breadthFirstTraverse=function(t,e,n,o){if(e instanceof f||(e=this._nodesMap[p(e)]),e){for(var d=n==="out"?"outEdges":n==="in"?"inEdges":"edges",s=0;s<this.nodes.length;s++)this.nodes[s].__visited=!1;if(!t.call(o,e,null))for(var r=[e];r.length;){var i=r.shift(),h=i[d];for(s=0;s<h.length;s++){var g=h[s],u=g.node1===i?g.node2:g.node1;if(!u.__visited){if(t.call(o,u,i))return;r.push(u),u.__visited=!0}}}}},a.prototype.update=function(){for(var t=this.data,e=this.edgeData,n=this.nodes,o=this.edges,d=0,s=n.length;d<s;d++)n[d].dataIndex=-1;for(d=0,s=t.count();d<s;d++)n[t.getRawIndex(d)].dataIndex=d;for(e.filterSelf(function(r){var i=o[e.getRawIndex(r)];return i.node1.dataIndex>=0&&i.node2.dataIndex>=0}),d=0,s=o.length;d<s;d++)o[d].dataIndex=-1;for(d=0,s=e.count();d<s;d++)o[e.getRawIndex(d)].dataIndex=d},a.prototype.clone=function(){for(var t=new a(this._directed),e=this.nodes,n=this.edges,o=0;o<e.length;o++)t.addNode(e[o].id,e[o].dataIndex);for(o=0;o<n.length;o++){var d=n[o];t.addEdge(d.node1.id,d.node2.id,d.dataIndex)}return t},a}(),f=function(){function a(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t??"",this.dataIndex=e??-1}return a.prototype.degree=function(){return this.edges.length},a.prototype.inDegree=function(){return this.inEdges.length},a.prototype.outDegree=function(){return this.outEdges.length},a.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t)},a.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var n=this.edges[e];n.dataIndex<0||(t.edge.push(n.dataIndex),t.node.push(n.node1.dataIndex,n.node2.dataIndex))}return t},a.prototype.getTrajectoryDataIndices=function(){for(var t=l(),e=l(),n=0;n<this.edges.length;n++){var o=this.edges[n];if(!(o.dataIndex<0)){t.set(o.dataIndex,!0);for(var d=[o.node1],s=[o.node2],r=0;r<d.length;){var i=d[r];r++,e.set(i.dataIndex,!0);for(var h=0;h<i.inEdges.length;h++)t.set(i.inEdges[h].dataIndex,!0),d.push(i.inEdges[h].node1)}for(r=0;r<s.length;){var g=s[r];for(r++,e.set(g.dataIndex,!0),h=0;h<g.outEdges.length;h++)t.set(g.outEdges[h].dataIndex,!0),s.push(g.outEdges[h].node2)}}}return{edge:t.keys(),node:e.keys()}},a}(),R=function(){function a(t,e,n){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=n??-1}return a.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t)},a.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},a.prototype.getTrajectoryDataIndices=function(){var t=l(),e=l();t.set(this.dataIndex,!0);for(var n=[this.node1],o=[this.node2],d=0;d<n.length;){var s=n[d];d++,e.set(s.dataIndex,!0);for(var r=0;r<s.inEdges.length;r++)t.set(s.inEdges[r].dataIndex,!0),n.push(s.inEdges[r].node1)}for(d=0;d<o.length;){var i=o[d];for(d++,e.set(i.dataIndex,!0),r=0;r<i.outEdges.length;r++)t.set(i.outEdges[r].dataIndex,!0),o.push(i.outEdges[r].node2)}return{edge:t.keys(),node:e.keys()}},a}();function w(a,t){return{getValue:function(e){var n=this[a][t];return n.getStore().get(n.getDimensionIndex(e||"value"),this.dataIndex)},setVisual:function(e,n){this.dataIndex>=0&&this[a][t].setItemVisual(this.dataIndex,e,n)},getVisual:function(e){return this[a][t].getItemVisual(this.dataIndex,e)},setLayout:function(e,n){this.dataIndex>=0&&this[a][t].setItemLayout(this.dataIndex,e,n)},getLayout:function(){return this[a][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[a][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[a][t].getRawIndex(this.dataIndex)}}}function b(a,t,e,n,o){for(var d=new B(n),s=0;s<a.length;s++)d.addNode(m(a[s].id,a[s].name,s),s);var r=[],i=[],h=0;for(s=0;s<t.length;s++){var g=t[s],u=g.source,y=g.target;d.addEdge(u,y,h)&&(i.push(g),r.push(m(N(g.id,null),u+" > "+y)),h++)}var c,I=e.get("coordinateSystem");if(I==="cartesian2d"||I==="polar")c=j(a,e);else{var E=k.get(I),x=E&&E.dimensions||[];L(x,"value")<0&&x.concat(["value"]);var G=V(a,{coordDimensions:x,encodeDefine:e.getEncode()}).dimensions;(c=new D(G,e)).initData(a)}var v=new D(["value"],e);return v.initData(i,r),o&&o(c,v),A({mainData:c,struct:d,structAttr:"graph",datas:{node:c,edge:v},datasAttr:{node:"data",edge:"edgeData"}}),d.update(),d}_(f,w("hostGraph","data")),_(R,w("hostGraph","edgeData"));export{b as l};
