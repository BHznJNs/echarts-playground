import{a2 as g,E as y,N as c,O as p,b5 as A,g as b,a0 as O}from"./index-CfHuJ7al.js";import{l as P,p as _,g as D}from"./brushHelper-BZO99mwp.js";var L=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],C=function(){function r(a,t,o){var e=this;this._targetInfoList=[];var n=h(t,a);c(B,function(i,u){(!o||!o.include||p(o.include,u)>=0)&&i(n,e._targetInfoList)})}return r.prototype.setOutputRanges=function(a,t){return this.matchOutputRanges(a,t,function(o,e,n){if((o.coordRanges||(o.coordRanges=[])).push(e),!o.coordRange){o.coordRange=e;var i=x[o.brushType](0,n,e);o.__rangeOffset={offset:I[o.brushType](i.values,o.range,[1,1]),xyMinMax:i.xyMinMax}}}),a},r.prototype.matchOutputRanges=function(a,t,o){c(a,function(e){var n=this.findTargetInfo(e,t);n&&n!==!0&&c(n.coordSyses,function(i){var u=x[e.brushType](1,i,e.range,!0);o(e,u.values,i,t)})},this)},r.prototype.setInputRanges=function(a,t){c(a,function(o){var e,n,i,u,s,d=this.findTargetInfo(o,t);if(o.range=o.range||[],d&&d!==!0){o.panelId=d.panelId;var f=x[o.brushType](0,d.coordSys,o.coordRange),l=o.__rangeOffset;o.range=l?I[o.brushType](f.values,l.offset,(e=f.xyMinMax,n=l.xyMinMax,i=N(e),u=N(n),s=[i[0]/u[0],i[1]/u[1]],isNaN(s[0])&&(s[0]=1),isNaN(s[1])&&(s[1]=1),s)):f.values}},this)},r.prototype.makePanelOpts=function(a,t){return y(this._targetInfoList,function(o){var e=o.getPanelRect();return{panelId:o.panelId,defaultBrushType:t?t(o):null,clipPath:P(e),isTargetByCursor:_(e,a,o.coordSysModel),getLinearBrushOtherExtent:D(e)}})},r.prototype.controlSeries=function(a,t,o){var e=this.findTargetInfo(a,o);return e===!0||e&&p(e.coordSyses,t.coordinateSystem)>=0},r.prototype.findTargetInfo=function(a,t){for(var o=this._targetInfoList,e=h(t,a),n=0;n<o.length;n++){var i=o[n],u=a.panelId;if(u){if(i.panelId===u)return i}else for(var s=0;s<M.length;s++)if(M[s](e,i))return i}return!0},r}();function v(r){return r[0]>r[1]&&r.reverse(),r}function h(r,a){return A(r,a,{includeMainTypes:L})}var B={grid:function(r,a){var t=r.xAxisModels,o=r.yAxisModels,e=r.gridModels,n=b(),i={},u={};(t||o||e)&&(c(t,function(s){var d=s.axis.grid.model;n.set(d.id,d),i[d.id]=!0}),c(o,function(s){var d=s.axis.grid.model;n.set(d.id,d),u[d.id]=!0}),c(e,function(s){n.set(s.id,s),i[s.id]=!0,u[s.id]=!0}),n.each(function(s){var d=s.coordinateSystem,f=[];c(d.getCartesians(),function(l,E){(p(t,l.getAxis("x").model)>=0||p(o,l.getAxis("y").model)>=0)&&f.push(l)}),a.push({panelId:"grid--"+s.id,gridModel:s,coordSysModel:s,coordSys:f[0],coordSyses:f,getPanelRect:m.grid,xAxisDeclared:i[s.id],yAxisDeclared:u[s.id]})}))},geo:function(r,a){c(r.geoModels,function(t){var o=t.coordinateSystem;a.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:o,coordSyses:[o],getPanelRect:m.geo})})}},M=[function(r,a){var t=r.xAxisModel,o=r.yAxisModel,e=r.gridModel;return!e&&t&&(e=t.axis.grid.model),!e&&o&&(e=o.axis.grid.model),e&&e===a.gridModel},function(r,a){var t=r.geoModel;return t&&t===a.geoModel}],m={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var r=this.coordSys,a=r.getBoundingRect().clone();return a.applyTransform(O(r)),a}},x={lineX:g(T,0),lineY:g(T,1),rect:function(r,a,t,o){var e=r?a.pointToData([t[0][0],t[1][0]],o):a.dataToPoint([t[0][0],t[1][0]],o),n=r?a.pointToData([t[0][1],t[1][1]],o):a.dataToPoint([t[0][1],t[1][1]],o),i=[v([e[0],n[0]]),v([e[1],n[1]])];return{values:i,xyMinMax:i}},polygon:function(r,a,t,o){var e=[[1/0,-1/0],[1/0,-1/0]];return{values:y(t,function(n){var i=r?a.pointToData(n,o):a.dataToPoint(n,o);return e[0][0]=Math.min(e[0][0],i[0]),e[1][0]=Math.min(e[1][0],i[1]),e[0][1]=Math.max(e[0][1],i[0]),e[1][1]=Math.max(e[1][1],i[1]),i}),xyMinMax:e}}};function T(r,a,t,o){var e=t.getAxis(["x","y"][r]),n=v(y([0,1],function(u){return a?e.coordToData(e.toLocalCoord(o[u]),!0):e.toGlobalCoord(e.dataToCoord(o[u]))})),i=[];return i[r]=n,i[1-r]=[NaN,NaN],{values:n,xyMinMax:i}}var I={lineX:g(S,0),lineY:g(S,1),rect:function(r,a,t){return[[r[0][0]-t[0]*a[0][0],r[0][1]-t[0]*a[0][1]],[r[1][0]-t[1]*a[1][0],r[1][1]-t[1]*a[1][1]]]},polygon:function(r,a,t){return y(r,function(o,e){return[o[0]-t[0]*a[e][0],o[1]-t[1]*a[e][1]]})}};function S(r,a,t,o){return[a[0]-o[r]*t[0],a[1]-o[r]*t[1]]}function N(r){return r?[r[0][1]-r[0][0],r[1][1]-r[1][0]]:[NaN,NaN]}var k=C,G=function(){},R={};function W(r,a){R[r]=a}function $(r){return R[r]}export{W as A,k as I,$ as N,G as S};
