import{e as K,j as fe,N as O,C as De,ai as Pe,g as ve,E as Re,b as Me,a5 as Ae,O as Oe,o as ke,Z as se,I as Le,a8 as ce,aj as Be,D as ge,ak as Te,f as Y,al as We,M as de,am as ze,U as pe,L as Ne,G as U,w as Ve,d as me,a9 as He,an as V,$ as Ee,c as Fe,X as Ue,ao as Ke,H as $e,T as je,ae as Je,ab as Xe,Y as Q,ap as Ze,a2 as T,A as Se,J as qe}from"./index-B7CpzWKR.js";import{o as Ye}from"./listComponent-CyA_ToLT.js";var ee=function(a){function n(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=n.type,e.layoutMode={type:"box",ignoreSize:!0},e}return K(n,a),n.prototype.init=function(e,t,i){this.mergeDefaultAndTheme(e,i),e.selected=e.selected||{},this._updateSelector(e)},n.prototype.mergeOption=function(e,t){a.prototype.mergeOption.call(this,e,t),this._updateSelector(e)},n.prototype._updateSelector=function(e){var t=e.selector,i=this.ecModel;t===!0&&(t=e.selector=["all","inverse"]),fe(t)&&O(t,function(o,r){U(o)&&(o={type:o}),t[r]=De(o,function(u,l){return l==="all"?{type:"all",title:u.getLocaleModel().get(["legend","selector","all"])}:l==="inverse"?{type:"inverse",title:u.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(i,o.type))})},n.prototype.optionUpdated=function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&this.get("selectedMode")==="single"){for(var t=!1,i=0;i<e.length;i++){var o=e[i].get("name");if(this.isSelected(o)){this.select(o),t=!0;break}}!t&&this.select(e[0].get("name"))}},n.prototype._updateData=function(e){var t=[],i=[];e.eachRawSeries(function(l){var g,s=l.name;if(i.push(s),l.legendVisualProvider){var h=l.legendVisualProvider.getAllNames();e.isSeriesFiltered(l)||(i=i.concat(h)),h.length?t=t.concat(h):g=!0}else g=!0;g&&Pe(l)&&t.push(l.name)}),this._availableNames=i;var o=this.get("data")||t,r=ve(),u=Re(o,function(l){return(U(l)||Ze(l))&&(l={name:l}),r.get(l.name)?null:(r.set(l.name,!0),new Me(l,this,this.ecModel))},this);this._data=Ae(u,function(l){return!!l})},n.prototype.getData=function(){return this._data},n.prototype.select=function(e){var t=this.option.selected;if(this.get("selectedMode")==="single"){var i=this._data;O(i,function(o){t[o.get("name")]=!1})}t[e]=!0},n.prototype.unSelect=function(e){this.get("selectedMode")!=="single"&&(this.option.selected[e]=!1)},n.prototype.toggleSelected=function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},n.prototype.allSelect=function(){var e=this._data,t=this.option.selected;O(e,function(i){t[i.get("name",!0)]=!0})},n.prototype.inverseSelect=function(){var e=this._data,t=this.option.selected;O(e,function(i){var o=i.get("name",!0);t.hasOwnProperty(o)||(t[o]=!0),t[o]=!t[o]})},n.prototype.isSelected=function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&Oe(this._availableNames,e)>=0},n.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},n.type="legend.plain",n.dependencies=["series"],n.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},n}(ke),B=T,X=O,F=Se;function ue(a,n,e,t){ne(a,n,e,t),e.dispatchAction({type:"legendToggleSelect",name:a??n}),te(a,n,e,t)}function xe(a){for(var n,e=a.getZr().storage.getDisplayList(),t=0,i=e.length;t<i&&!(n=e[t].states.emphasis);)t++;return n&&n.hoverLayer}function te(a,n,e,t){xe(e)||e.dispatchAction({type:"highlight",seriesName:a,name:n,excludeSeriesId:t})}function ne(a,n,e,t){xe(e)||e.dispatchAction({type:"downplay",seriesName:a,name:n,excludeSeriesId:t})}var Ie=function(a){function n(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=n.type,e.newlineDisabled=!1,e}return K(n,a),n.prototype.init=function(){this.group.add(this._contentGroup=new F),this.group.add(this._selectorGroup=new F),this._isFirstRender=!0},n.prototype.getContentGroup=function(){return this._contentGroup},n.prototype.getSelectorGroup=function(){return this._selectorGroup},n.prototype.render=function(e,t,i){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),e.get("show",!0)){var r=e.get("align"),u=e.get("orient");r&&r!=="auto"||(r=e.get("left")==="right"&&u==="vertical"?"right":"left");var l=e.get("selector",!0),g=e.get("selectorPosition",!0);!l||g&&g!=="auto"||(g=u==="horizontal"?"end":"start"),this.renderInner(r,e,t,i,l,u,g);var s=e.getBoxLayoutParams(),h={width:i.getWidth(),height:i.getHeight()},d=e.get("padding"),f=se(s,h,d),p=this.layoutInner(e,r,f,o,l,g),c=se(Le({width:p.width,height:p.height},s),h,d);this.group.x=c.x-p.x,this.group.y=c.y-p.y,this.group.markRedraw(),this.group.add(this._backgroundEl=Ye(p,e))}},n.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},n.prototype.renderInner=function(e,t,i,o,r,u,l){var g=this.getContentGroup(),s=ve(),h=t.get("selectedMode"),d=[];i.eachRawSeries(function(f){!f.get("legendHoverLink")&&d.push(f.id)}),X(t.getData(),function(f,p){var c=f.get("name");if(!this.newlineDisabled&&(c===""||c===`
`)){var m=new F;return m.newline=!0,void g.add(m)}var v=i.getSeriesByName(c)[0];if(!s.get(c))if(v){var y=v.getData(),S=y.getVisual("legendLineStyle")||{},w=y.getVisual("legendIcon"),x=y.getVisual("style"),I=this._createItem(v,c,p,f,t,e,S,x,w,h,o);I.on("click",B(ue,c,null,o,d)).on("mouseover",B(te,v.name,null,o,d)).on("mouseout",B(ne,v.name,null,o,d)),i.ssr&&I.eachChild(function(G){var b=ce(G);b.seriesIndex=v.seriesIndex,b.dataIndex=p,b.ssrType="legend"}),s.set(c,!0)}else i.eachRawSeries(function(G){if(!s.get(c)&&G.legendVisualProvider){var b=G.legendVisualProvider;if(!b.containName(c))return;var H=b.indexOfName(c),P=b.getItemVisual(H,"style"),W=b.getItemVisual(H,"legendIcon"),A=Be(P.fill);A&&A[3]===0&&(A[3]=.2,P=ge(ge({},P),{fill:Te(A,"rgba")}));var k=this._createItem(G,c,p,f,t,e,{},P,W,h,o);k.on("click",B(ue,null,c,o,d)).on("mouseover",B(te,null,c,o,d)).on("mouseout",B(ne,null,c,o,d)),i.ssr&&k.eachChild(function(E){var C=ce(E);C.seriesIndex=G.seriesIndex,C.dataIndex=p,C.ssrType="legend"}),s.set(c,!0)}},this)},this),r&&this._createSelector(r,t,o,u,l)},n.prototype._createSelector=function(e,t,i,o,r){var u=this.getSelectorGroup();X(e,function(l){var g=l.type,s=new Y({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:g==="all"?"legendAllSelect":"legendInverseSelect"})}});u.add(s);var h=t.getModel("selectorLabel"),d=t.getModel(["emphasis","selectorLabel"]);We(s,{normal:h,emphasis:d},{defaultText:l.title}),de(s)})},n.prototype._createItem=function(e,t,i,o,r,u,l,g,s,h,d){var f=e.visualDrawType,p=r.get("itemWidth"),c=r.get("itemHeight"),m=r.isSelected(t),v=o.get("symbolRotate"),y=o.get("symbolKeepAspect"),S=o.get("icon"),w=function(C,M,D,R,ie,Ce,we){function oe(z,ae){z.lineWidth==="auto"&&(z.lineWidth=ae.lineWidth>0?2:0),X(z,function(it,J){z[J]==="inherit"&&(z[J]=ae[J])})}var re=M.getModel("itemStyle"),_=re.getItemStyle(),le=C.lastIndexOf("empty",0)===0?"fill":"stroke",$=re.getShallow("decal");_.decal=$&&$!=="inherit"?ze($,we):R.decal,_.fill==="inherit"&&(_.fill=R[ie]),_.stroke==="inherit"&&(_.stroke=R[le]),_.opacity==="inherit"&&(_.opacity=(ie==="fill"?R:D).opacity),oe(_,R);var j=M.getModel("lineStyle"),L=j.getLineStyle();if(oe(L,D),_.fill==="auto"&&(_.fill=R.fill),_.stroke==="auto"&&(_.stroke=R.fill),L.stroke==="auto"&&(L.stroke=R.fill),!Ce){var Ge=M.get("inactiveBorderWidth"),be=_[le];_.lineWidth=Ge==="auto"?R.lineWidth>0&&be?2:0:_.lineWidth,_.fill=M.get("inactiveColor"),_.stroke=M.get("inactiveBorderColor"),L.stroke=j.get("inactiveColor"),L.lineWidth=j.get("inactiveWidth")}return{itemStyle:_,lineStyle:L}}(s=S||s||"roundRect",o,l,g,f,m,d),x=new F,I=o.getModel("textStyle");if(!pe(e.getLegendIcon)||S&&S!=="inherit"){var G=S==="inherit"&&e.getData().getVisual("symbol")?v==="inherit"?e.getData().getVisual("symbolRotate"):v:0;x.add(function(C){var M=C.icon||"roundRect",D=Ne(M,0,0,C.itemWidth,C.itemHeight,C.itemStyle.fill,C.symbolKeepAspect);return D.setStyle(C.itemStyle),D.rotation=(C.iconRotate||0)*Math.PI/180,D.setOrigin([C.itemWidth/2,C.itemHeight/2]),M.indexOf("empty")>-1&&(D.style.stroke=D.style.fill,D.style.fill="#fff",D.style.lineWidth=2),D}({itemWidth:p,itemHeight:c,icon:s,iconRotate:G,itemStyle:w.itemStyle,lineStyle:w.lineStyle,symbolKeepAspect:y}))}else x.add(e.getLegendIcon({itemWidth:p,itemHeight:c,icon:s,iconRotate:v,itemStyle:w.itemStyle,lineStyle:w.lineStyle,symbolKeepAspect:y}));var b=u==="left"?p+5:-5,H=u,P=r.get("formatter"),W=t;U(P)&&P?W=P.replace("{name}",t??""):pe(P)&&(W=P(t));var A=m?I.getTextColor():o.get("inactiveColor");x.add(new Y({style:Ve(I,{text:W,x:b,y:c/2,fill:A,align:H,verticalAlign:"middle"},{inheritColor:A})}));var k=new me({shape:x.getBoundingRect(),style:{fill:"transparent"}}),E=o.getModel("tooltip");return E.get("show")&&He({el:k,componentModel:r,itemName:t,itemTooltipOption:E.option}),x.add(k),x.eachChild(function(C){C.silent=!0}),k.silent=!h,this.getContentGroup().add(x),de(x),x.__legendDataIndex=i,x},n.prototype.layoutInner=function(e,t,i,o,r,u){var l=this.getContentGroup(),g=this.getSelectorGroup();V(e.get("orient"),l,e.get("itemGap"),i.width,i.height);var s=l.getBoundingRect(),h=[-s.x,-s.y];if(g.markRedraw(),l.markRedraw(),r){V("horizontal",g,e.get("selectorItemGap",!0));var d=g.getBoundingRect(),f=[-d.x,-d.y],p=e.get("selectorButtonGap",!0),c=e.getOrient().index,m=c===0?"width":"height",v=c===0?"height":"width",y=c===0?"y":"x";u==="end"?f[c]+=s[m]+p:h[c]+=d[m]+p,f[1-c]+=s[v]/2-d[v]/2,g.x=f[0],g.y=f[1],l.x=h[0],l.y=h[1];var S={x:0,y:0};return S[m]=s[m]+p+d[m],S[v]=Math.max(s[v],d[v]),S[y]=Math.min(0,d[y]+f[1-c]),S}return l.x=h[0],l.y=h[1],this.group.getBoundingRect()},n.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},n.type="legend.plain",n}(Ee);function Qe(a){var n=a.findComponents({mainType:"legend"});n&&n.length&&a.filterSeries(function(e){for(var t=0;t<n.length;t++)if(!n[t].isSelected(e.name))return!1;return!0})}function N(a,n,e){var t,i={},o=a==="toggleSelected";return e.eachComponent("legend",function(r){o&&t!=null?r[t?"select":"unSelect"](n.name):a==="allSelect"||a==="inverseSelect"?r[a]():(r[a](n.name),t=r.isSelected(n.name));var u=r.getData();O(u,function(l){var g=l.get("name");if(g!==`
`&&g!==""){var s=r.isSelected(g);i.hasOwnProperty(g)?i[g]=i[g]&&s:i[g]=s}})}),a==="allSelect"||a==="inverseSelect"?{selected:i}:{name:n.name,selected:i}}function _e(a){a.registerComponentModel(ee),a.registerComponentView(Ie),a.registerProcessor(a.PRIORITY.PROCESSOR.SERIES_FILTER,Qe),a.registerSubTypeDefaulter("legend",function(){return"plain"}),function(n){n.registerAction("legendToggleSelect","legendselectchanged",T(N,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",T(N,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",T(N,"inverseSelect")),n.registerAction("legendSelect","legendselected",T(N,"select")),n.registerAction("legendUnSelect","legendunselected",T(N,"unSelect"))}(a)}function he(a,n,e){var t=[1,1];t[a.getOrient().index]=0,qe(n,e,{type:"box",ignoreSize:!!t})}var et=function(a){function n(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=n.type,e}return K(n,a),n.prototype.setScrollDataIndex=function(e){this.option.scrollDataIndex=e},n.prototype.init=function(e,t,i){var o=Fe(e);a.prototype.init.call(this,e,t,i),he(this,e,o)},n.prototype.mergeOption=function(e,t){a.prototype.mergeOption.call(this,e,t),he(this,this.option,e)},n.type="legend.scroll",n.defaultOption=Ue(ee.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),n}(ee),ye=Se,Z=["width","height"],q=["x","y"],tt=function(a){function n(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=n.type,e.newlineDisabled=!0,e._currentIndex=0,e}return K(n,a),n.prototype.init=function(){a.prototype.init.call(this),this.group.add(this._containerGroup=new ye),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new ye)},n.prototype.resetInner=function(){a.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},n.prototype.renderInner=function(e,t,i,o,r,u,l){var g=this;a.prototype.renderInner.call(this,e,t,i,o,r,u,l);var s=this._controllerGroup,h=t.get("pageIconSize",!0),d=fe(h)?h:[h,h];p("pagePrev",0);var f=t.getModel("pageTextStyle");function p(c,m){var v=c+"DataIndex",y=Ke(t.get("pageIcons",!0)[t.getOrient().name][m],{onclick:$e(g._pageGo,g,v,t,o)},{x:-d[0]/2,y:-d[1]/2,width:d[0],height:d[1]});y.name=c,s.add(y)}s.add(new Y({name:"pageText",style:{text:"xx/xx",fill:f.getTextColor(),font:f.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),p("pageNext",1)},n.prototype.layoutInner=function(e,t,i,o,r,u){var l=this.getSelectorGroup(),g=e.getOrient().index,s=Z[g],h=q[g],d=Z[1-g],f=q[1-g];r&&V("horizontal",l,e.get("selectorItemGap",!0));var p=e.get("selectorButtonGap",!0),c=l.getBoundingRect(),m=[-c.x,-c.y],v=je(i);r&&(v[s]=i[s]-c[s]-p);var y=this._layoutContentAndController(e,o,v,g,s,d,f,h);if(r){if(u==="end")m[g]+=y[s]+p;else{var S=c[s]+p;m[g]-=S,y[h]-=S}y[s]+=c[s]+p,m[1-g]+=y[f]+y[d]/2-c[d]/2,y[d]=Math.max(y[d],c[d]),y[f]=Math.min(y[f],c[f]+m[1-g]),l.x=m[0],l.y=m[1],l.markRedraw()}return y},n.prototype._layoutContentAndController=function(e,t,i,o,r,u,l,g){var s=this.getContentGroup(),h=this._containerGroup,d=this._controllerGroup;V(e.get("orient"),s,e.get("itemGap"),o?i.width:null,o?null:i.height),V("horizontal",d,e.get("pageButtonItemGap",!0));var f=s.getBoundingRect(),p=d.getBoundingRect(),c=this._showController=f[r]>i[r],m=[-f.x,-f.y];t||(m[o]=s[g]);var v=[0,0],y=[-p.x,-p.y],S=Je(e.get("pageButtonGap",!0),e.get("itemGap",!0));c&&(e.get("pageButtonPosition",!0)==="end"?y[o]+=i[r]-p[r]:v[o]+=p[r]+S),y[1-o]+=f[u]/2-p[u]/2,s.setPosition(m),h.setPosition(v),d.setPosition(y);var w={x:0,y:0};if(w[r]=c?i[r]:f[r],w[u]=Math.max(f[u],p[u]),w[l]=Math.min(0,p[l]+y[1-o]),h.__rectSize=i[r],c){var x={x:0,y:0};x[r]=Math.max(i[r]-p[r]-S,0),x[u]=w[u],h.setClipPath(new me({shape:x})),h.__rectSize=x[r]}else d.eachChild(function(G){G.attr({invisible:!0,silent:!0})});var I=this._getPageInfo(e);return I.pageIndex!=null&&Xe(s,{x:I.contentPosition[0],y:I.contentPosition[1]},c?e:null),this._updatePageInfoView(e,I),w},n.prototype._pageGo=function(e,t,i){var o=this._getPageInfo(t)[e];o!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:o,legendId:t.id})},n.prototype._updatePageInfoView=function(e,t){var i=this._controllerGroup;O(["pagePrev","pageNext"],function(s){var h=t[s+"DataIndex"]!=null,d=i.childOfName(s);d&&(d.setStyle("fill",h?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var o=i.childOfName("pageText"),r=e.get("pageFormatter"),u=t.pageIndex,l=u!=null?u+1:0,g=t.pageCount;o&&r&&o.setStyle("text",U(r)?r.replace("{current}",l==null?"":l+"").replace("{total}",g==null?"":g+""):r({current:l,total:g}))},n.prototype._getPageInfo=function(e){var t=e.get("scrollDataIndex",!0),i=this.getContentGroup(),o=this._containerGroup.__rectSize,r=e.getOrient().index,u=Z[r],l=q[r],g=this._findTargetItemIndex(t),s=i.children(),h=s[g],d=s.length,f=d?1:0,p={contentPosition:[i.x,i.y],pageCount:f,pageIndex:f-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!h)return p;var c=w(h);p.contentPosition[r]=-c.s;for(var m=g+1,v=c,y=c,S=null;m<=d;++m)(!(S=w(s[m]))&&y.e>v.s+o||S&&!x(S,v.s))&&(v=y.i>v.i?y:S)&&(p.pageNextDataIndex==null&&(p.pageNextDataIndex=v.i),++p.pageCount),y=S;for(m=g-1,v=c,y=c,S=null;m>=-1;--m)(S=w(s[m]))&&x(y,S.s)||!(v.i<y.i)||(y=v,p.pagePrevDataIndex==null&&(p.pagePrevDataIndex=v.i),++p.pageCount,++p.pageIndex),v=S;return p;function w(I){if(I){var G=I.getBoundingRect(),b=G[l]+I[l];return{s:b,e:b+G[u],i:I.__legendDataIndex}}}function x(I,G){return I.e>=G&&I.s<=G+o}},n.prototype._findTargetItemIndex=function(e){return this._showController?(this.getContentGroup().eachChild(function(o,r){var u=o.__legendDataIndex;i==null&&u!=null&&(i=r),u===e&&(t=r)}),t??i):0;var t,i},n.type="legend.scroll",n}(Ie);function nt(a){Q(_e),a.registerComponentModel(et),a.registerComponentView(tt),function(n){n.registerAction("legendScroll","legendscroll",function(e,t){var i=e.scrollDataIndex;i!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(o){o.setScrollDataIndex(i)})})}(a)}function lt(a){Q(_e),Q(nt)}export{lt as install};
