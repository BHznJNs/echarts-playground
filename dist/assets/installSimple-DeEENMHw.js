import{e as m,o as R,as as C,at as J,au as N,cZ as j,z as T,cx as w,av as K,A as Q,D as U,c$ as L,N as g,aD as Y,j as q,az as I,I as V,aK as G,d as X,$,E as tt,a5 as et,Z as it,d0 as ot,aB as nt,O as A,aJ as rt,d1 as st,ag as at,aI as P,aH as ut}from"./index-DqzYUymv.js";import{u as D}from"./axisModelCreator-9f33LnYD.js";import{x as ct,P as lt,u as z,c as E}from"./AxisView-Dt0Gp6ZK.js";import{s as pt}from"./axisAlignTicks-D_xBRTER.js";import{C as ht}from"./AxisBuilder-BvSfZ_CI.js";import{s as dt,i as xt}from"./axisSplitHelper-QwkAk2Ym.js";var ft=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return m(e,n),e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(R),M=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return m(e,n),e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",C).models[0]},e.type="cartesian2dAxis",e}(R);J(M,N);var gt=function(){function n(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return n.prototype.getAxis=function(e){return this._axes[e]},n.prototype.getAxes=function(){return tt(this._dimList,function(e){return this._axes[e]},this)},n.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),et(this.getAxes(),function(t){return t.scale.type===e})},n.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},n}(),S=["x","y"];function k(n){return n.type==="interval"||n.type==="time"}var yt=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=S,t}return m(e,n),e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,o=this.getAxis("y").scale;if(k(t)&&k(o)){var i=t.getExtent(),s=o.getExtent(),r=this.dataToPoint([i[0],s[0]]),a=this.dataToPoint([i[1],s[1]]),u=i[1]-i[0],c=s[1]-s[0];if(u&&c){var l=(a[0]-r[0])/u,p=(a[1]-r[1])/c,h=r[0]-i[0]*l,d=r[1]-s[0]*p,x=this._transform=[l,0,0,p,h,d];this._invTransform=j([],x)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var o=this.getAxis("x"),i=this.getAxis("y");return o.contain(o.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,o){var i=this.dataToPoint(t),s=this.dataToPoint(o),r=this.getArea(),a=new T(i[0],i[1],s[0]-i[0],s[1]-i[1]);return r.intersect(a)},e.prototype.dataToPoint=function(t,o,i){i=i||[];var s=t[0],r=t[1];if(this._transform&&s!=null&&isFinite(s)&&r!=null&&isFinite(r))return w(i,t,this._transform);var a=this.getAxis("x"),u=this.getAxis("y");return i[0]=a.toGlobalCoord(a.dataToCoord(s,o)),i[1]=u.toGlobalCoord(u.dataToCoord(r,o)),i},e.prototype.clampData=function(t,o){var i=this.getAxis("x").scale,s=this.getAxis("y").scale,r=i.getExtent(),a=s.getExtent(),u=i.parse(t[0]),c=s.parse(t[1]);return(o=o||[])[0]=Math.min(Math.max(Math.min(r[0],r[1]),u),Math.max(r[0],r[1])),o[1]=Math.min(Math.max(Math.min(a[0],a[1]),c),Math.max(a[0],a[1])),o},e.prototype.pointToData=function(t,o){var i=[];if(this._invTransform)return w(i,t,this._invTransform);var s=this.getAxis("x"),r=this.getAxis("y");return i[0]=s.coordToData(s.toLocalCoord(t[0]),o),i[1]=r.coordToData(r.toLocalCoord(t[1]),o),i},e.prototype.getOtherAxis=function(t){return this.getAxis(t.dim==="x"?"y":"x")},e.prototype.getArea=function(t){t=t||0;var o=this.getAxis("x").getGlobalExtent(),i=this.getAxis("y").getGlobalExtent(),s=Math.min(o[0],o[1])-t,r=Math.min(i[0],i[1])-t,a=Math.max(o[0],o[1])-s+t,u=Math.max(i[0],i[1])-r+t;return new T(s,r,a,u)},e}(gt),mt=function(n){function e(t,o,i,s,r){var a=n.call(this,t,o,i)||this;return a.index=0,a.type=s||"value",a.position=r||"bottom",a}return m(e,n),e.prototype.isHorizontal=function(){var t=this.position;return t==="top"||t==="bottom"},e.prototype.getGlobalExtent=function(t){var o=this.getExtent();return o[0]=this.toGlobalCoord(o[0]),o[1]=this.toGlobalCoord(o[1]),t&&o[0]>o[1]&&o.reverse(),o},e.prototype.pointToData=function(t,o){return this.coordToData(this.toLocalCoord(t[this.dim==="x"?0:1]),o)},e.prototype.setCategorySortInfo=function(t){if(this.type!=="category")return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(K);function _(n,e){return n.getCoordSysModel()===e}function B(n,e,t,o){t.getAxesOnZeroOf=function(){return i?[i]:[]};var i,s=n[e],r=t.model,a=r.get(["axisLine","onZero"]),u=r.get(["axisLine","onZeroAxisIndex"]);if(a){if(u!=null)O(s[u])&&(i=s[u]);else for(var c in s)if(s.hasOwnProperty(c)&&O(s[c])&&!o[l(s[c])]){i=s[c];break}i&&(o[l(i)]=!0)}function l(p){return p.dim+"_"+p.index}}function O(n){return n&&n.type!=="category"&&n.type!=="time"&&st(n)}var vt=function(){function n(e,t,o){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=S,this._initCartesian(e,t,o),this.model=e}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(e,t){var o=this._axesMap;function i(r){var a,u=at(r),c=u.length;if(c){for(var l=[],p=c-1;p>=0;p--){var h=r[+u[p]],d=h.model,x=h.scale;L(x)&&d.get("alignTicks")&&d.get("interval")==null?l.push(h):(P(x,d),L(x)&&(a=h))}l.length&&(a||(a=l.pop(),P(a.scale,a.model)),g(l,function(f){pt(f.scale,f.model,a.scale)}))}}this._updateScale(e,this.model),i(o.x),i(o.y);var s={};g(o.x,function(r){B(o,"y",r,s)}),g(o.y,function(r){B(o,"x",r,s)}),this.resize(this.model,t)},n.prototype.resize=function(e,t,o){var i=e.getBoxLayoutParams(),s=!o&&e.get("containLabel"),r=it(i,{width:t.getWidth(),height:t.getHeight()});this._rect=r;var a=this._axesList;function u(){g(a,function(c){var l=c.isHorizontal(),p=l?[0,r.width]:[0,r.height],h=c.inverse?1:0;c.setExtent(p[h],p[1-h]),function(d,x){var f=d.getExtent(),v=f[0]+f[1];d.toGlobalCoord=d.dim==="x"?function(y){return y+x}:function(y){return v-y+x},d.toLocalCoord=d.dim==="x"?function(y){return y-x}:function(y){return v-y+x}}(c,l?r.x:r.y)})}u(),s&&(g(a,function(c){if(!c.model.get(["axisLabel","inside"])){var l=ot(c);if(l){var p=c.isHorizontal()?"height":"width",h=c.model.get(["axisLabel","margin"]);r[p]-=l[p]+h,c.position==="top"?r.y+=l.height+h:c.position==="left"&&(r.x+=l.width+h)}}}),u()),g(this._coordsList,function(c){c.calcAffineTransform()})},n.prototype.getAxis=function(e,t){var o=this._axesMap[e];if(o!=null)return o[t||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(e,t){if(e!=null&&t!=null){var o="x"+e+"y"+t;return this._coordsMap[o]}nt(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,s=this._coordsList;i<s.length;i++)if(s[i].getAxis("x").index===e||s[i].getAxis("y").index===t)return s[i]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(e,t,o){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.dataToPoint(o):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(o)):null},n.prototype.convertFromPixel=function(e,t,o){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.pointToData(o):i.axis?i.axis.coordToData(i.axis.toLocalCoord(o)):null},n.prototype._findConvertTarget=function(e){var t,o,i=e.seriesModel,s=e.xAxisModel||i&&i.getReferringComponents("xAxis",C).models[0],r=e.yAxisModel||i&&i.getReferringComponents("yAxis",C).models[0],a=e.gridModel,u=this._coordsList;return i?(t=i.coordinateSystem,A(u,t)<0&&(t=null)):s&&r?t=this.getCartesian(s.componentIndex,r.componentIndex):s?o=this.getAxis("x",s.componentIndex):r?o=this.getAxis("y",r.componentIndex):a&&a.coordinateSystem===this&&(t=this._coordsList[0]),{cartesian:t,axis:o}},n.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},n.prototype._initCartesian=function(e,t,o){var i=this,s=this,r={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},u={x:0,y:0};if(t.eachComponent("xAxis",c("x"),this),t.eachComponent("yAxis",c("y"),this),!u.x||!u.y)return this._axesMap={},void(this._axesList=[]);function c(l){return function(p,h){if(_(p,e)){var d=p.get("position");l==="x"?d!=="top"&&d!=="bottom"&&(d=r.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=r.left?"right":"left"),r[d]=!0;var x=new mt(l,rt(p),[0,0],p.get("type"),d),f=x.type==="category";x.onBand=f&&p.get("boundaryGap"),x.inverse=p.get("inverse"),p.axis=x,x.model=p,x.grid=s,x.index=h,s._axesList.push(x),a[l][h]=x,u[l]++}}}this._axesMap=a,g(a.x,function(l,p){g(a.y,function(h,d){var x="x"+p+"y"+d,f=new yt(x);f.master=i,f.model=e,i._coordsMap[x]=f,i._coordsList.push(f),f.addAxis(l),f.addAxis(h)})})},n.prototype._updateScale=function(e,t){function o(i,s){g(ut(i,s.dim),function(r){s.scale.unionExtentFromData(i,r)})}g(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var s=i.model.get("categorySortInfo");i.scale.setSortInfo(s)}}),e.eachSeries(function(i){if(z(i)){var s=E(i),r=s.xAxisModel,a=s.yAxisModel;if(!_(r,t)||!_(a,t))return;var u=this.getCartesian(r.componentIndex,a.componentIndex),c=i.getData(),l=u.getAxis("x"),p=u.getAxis("y");o(c,l),o(c,p)}},this)},n.prototype.getTooltipAxes=function(e){var t=[],o=[];return g(this.getCartesians(),function(i){var s=e!=null&&e!=="auto"?i.getAxis(e):i.getBaseAxis(),r=i.getOtherAxis(s);A(t,s)<0&&t.push(s),A(o,r)<0&&o.push(r)}),{baseAxes:t,otherAxes:o}},n.create=function(e,t){var o=[];return e.eachComponent("grid",function(i,s){var r=new n(i,e,t);r.name="grid_"+s,r.resize(i,t,!0),i.coordinateSystem=r,o.push(r)}),e.eachSeries(function(i){if(z(i)){var s=E(i),r=s.xAxisModel,a=s.yAxisModel,u=r.getCoordSysModel().coordinateSystem;i.coordinateSystem=u.getCartesian(r.componentIndex,a.componentIndex)}}),o},n.dimensions=S,n}(),At=["axisLine","axisTickLabel","axisName"],_t=["splitArea","splitLine","minorSplitLine"],Z=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="CartesianAxisPointer",t}return m(e,n),e.prototype.render=function(t,o,i,s){this.group.removeAll();var r=this._axisGroup;if(this._axisGroup=new Q,this.group.add(this._axisGroup),t.get("show")){var a=t.getCoordSysModel(),u=ct(a,t),c=new ht(t,U({handleAutoShown:function(l){for(var p=a.coordinateSystem.getCartesians(),h=0;h<p.length;h++)if(L(p[h].getOtherAxis(t.axis).scale))return!0;return!1}},u));g(At,c.add,c),this._axisGroup.add(c.getGroup()),g(_t,function(l){t.get([l,"show"])&&Ct[l](this,this._axisGroup,t,a)},this),s&&s.type==="changeAxisOrder"&&s.isInitSort||Y(r,this._axisGroup,t),n.prototype.render.call(this,t,o,i,s)}},e.prototype.remove=function(){dt(this)},e.type="cartesianAxis",e}(lt),Ct={splitLine:function(n,e,t,o){var i=t.axis;if(!i.scale.isBlank()){var s=t.getModel("splitLine"),r=s.getModel("lineStyle"),a=r.get("color");a=q(a)?a:[a];for(var u=o.coordinateSystem.getRect(),c=i.isHorizontal(),l=0,p=i.getTicksCoords({tickModel:s}),h=[],d=[],x=r.getLineStyle(),f=0;f<p.length;f++){var v=i.toGlobalCoord(p[f].coord);c?(h[0]=v,h[1]=u.y,d[0]=v,d[1]=u.y+u.height):(h[0]=u.x,h[1]=v,d[0]=u.x+u.width,d[1]=v);var y=l++%a.length,W=p[f].tickValue,b=new I({anid:W!=null?"line_"+p[f].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:V({stroke:a[y]},x),silent:!0});G(b.shape,x.lineWidth),e.add(b)}}},minorSplitLine:function(n,e,t,o){var i=t.axis,s=t.getModel("minorSplitLine").getModel("lineStyle"),r=o.coordinateSystem.getRect(),a=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var c=[],l=[],p=s.getLineStyle(),h=0;h<u.length;h++)for(var d=0;d<u[h].length;d++){var x=i.toGlobalCoord(u[h][d].coord);a?(c[0]=x,c[1]=r.y,l[0]=x,l[1]=r.y+r.height):(c[0]=r.x,c[1]=x,l[0]=r.x+r.width,l[1]=x);var f=new I({anid:"minor_line_"+u[h][d].tickValue,autoBatch:!0,shape:{x1:c[0],y1:c[1],x2:l[0],y2:l[1]},style:p,silent:!0});G(f.shape,p.lineWidth),e.add(f)}},splitArea:function(n,e,t,o){xt(n,e,t,o)}},F=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return m(e,n),e.type="xAxis",e}(Z),Lt=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=F.type,t}return m(e,n),e.type="yAxis",e}(Z),Mt=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="grid",t}return m(e,n),e.prototype.render=function(t,o){this.group.removeAll(),t.get("show")&&this.group.add(new X({shape:t.coordinateSystem.getRect(),style:V({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}($),H={offset:0};function Pt(n){n.registerComponentView(Mt),n.registerComponentModel(ft),n.registerCoordinateSystem("cartesian2d",vt),D(n,"x",M,H),D(n,"y",M,H),n.registerComponentView(F),n.registerComponentView(Lt),n.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}export{Pt as r};
