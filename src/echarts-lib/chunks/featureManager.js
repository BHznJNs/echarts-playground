import{w as n,m as e,e as t,B as o,d7 as r,b4 as a,c2 as i}from"./index.js";import{m as s,a as u,b as d}from"./brushHelper.js";var c=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],f=function(){function n(n,e,r){var a=this;this._targetInfoList=[];var i=g(e,n);t(p,(function(n,e){(!r||!r.include||o(r.include,e)>=0)&&n(i,a._targetInfoList)}))}return n.prototype.setOutputRanges=function(n,e){return this.matchOutputRanges(n,e,(function(n,e,t){if((n.coordRanges||(n.coordRanges=[])).push(e),!n.coordRange){n.coordRange=e;var o=h[n.brushType](0,t,e);n.__rangeOffset={offset:M[n.brushType](o.values,n.range,[1,1]),xyMinMax:o.xyMinMax}}})),n},n.prototype.matchOutputRanges=function(n,e,o){t(n,(function(n){var r=this.findTargetInfo(n,e);r&&!0!==r&&t(r.coordSyses,(function(t){var r=h[n.brushType](1,t,n.range,!0);o(n,r.values,t,e)}))}),this)},n.prototype.setInputRanges=function(n,e){t(n,(function(n){var t,o,r,a,i,s=this.findTargetInfo(n,e);if(n.range=n.range||[],s&&!0!==s){n.panelId=s.panelId;var u=h[n.brushType](0,s.coordSys,n.coordRange),d=n.__rangeOffset;n.range=d?M[n.brushType](u.values,d.offset,(t=u.xyMinMax,o=d.xyMinMax,r=T(t),a=T(o),i=[r[0]/a[0],r[1]/a[1]],isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i)):u.values}}),this)},n.prototype.makePanelOpts=function(n,t){return e(this._targetInfoList,(function(e){var o=e.getPanelRect();return{panelId:e.panelId,defaultBrushType:t?t(e):null,clipPath:s(o),isTargetByCursor:u(o,n,e.coordSysModel),getLinearBrushOtherExtent:d(o)}}))},n.prototype.controlSeries=function(n,e,t){var r=this.findTargetInfo(n,t);return!0===r||r&&o(r.coordSyses,e.coordinateSystem)>=0},n.prototype.findTargetInfo=function(n,e){for(var t=this._targetInfoList,o=g(e,n),r=0;r<t.length;r++){var a=t[r],i=n.panelId;if(i){if(a.panelId===i)return a}else for(var s=0;s<y.length;s++)if(y[s](o,a))return a}return!0},n}();function l(n){return n[0]>n[1]&&n.reverse(),n}function g(n,e){return r(n,e,{includeMainTypes:c})}var p={grid:function(n,e){var r=n.xAxisModels,i=n.yAxisModels,s=n.gridModels,u=a(),d={},c={};(r||i||s)&&(t(r,(function(n){var e=n.axis.grid.model;u.set(e.id,e),d[e.id]=!0})),t(i,(function(n){var e=n.axis.grid.model;u.set(e.id,e),c[e.id]=!0})),t(s,(function(n){u.set(n.id,n),d[n.id]=!0,c[n.id]=!0})),u.each((function(n){var a=n.coordinateSystem,s=[];t(a.getCartesians(),(function(n,e){(o(r,n.getAxis("x").model)>=0||o(i,n.getAxis("y").model)>=0)&&s.push(n)})),e.push({panelId:"grid--"+n.id,gridModel:n,coordSysModel:n,coordSys:s[0],coordSyses:s,getPanelRect:x.grid,xAxisDeclared:d[n.id],yAxisDeclared:c[n.id]})})))},geo:function(n,e){t(n.geoModels,(function(n){var t=n.coordinateSystem;e.push({panelId:"geo--"+n.id,geoModel:n,coordSysModel:n,coordSys:t,coordSyses:[t],getPanelRect:x.geo})}))}},y=[function(n,e){var t=n.xAxisModel,o=n.yAxisModel,r=n.gridModel;return!r&&t&&(r=t.axis.grid.model),!r&&o&&(r=o.axis.grid.model),r&&r===e.gridModel},function(n,e){var t=n.geoModel;return t&&t===e.geoModel}],x={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,e=n.getBoundingRect().clone();return e.applyTransform(i(n)),e}},h={lineX:n(v,0),lineY:n(v,1),rect:function(n,e,t,o){var r=n?e.pointToData([t[0][0],t[1][0]],o):e.dataToPoint([t[0][0],t[1][0]],o),a=n?e.pointToData([t[0][1],t[1][1]],o):e.dataToPoint([t[0][1],t[1][1]],o),i=[l([r[0],a[0]]),l([r[1],a[1]])];return{values:i,xyMinMax:i}},polygon:function(n,t,o,r){var a=[[1/0,-1/0],[1/0,-1/0]];return{values:e(o,(function(e){var o=n?t.pointToData(e,r):t.dataToPoint(e,r);return a[0][0]=Math.min(a[0][0],o[0]),a[1][0]=Math.min(a[1][0],o[1]),a[0][1]=Math.max(a[0][1],o[0]),a[1][1]=Math.max(a[1][1],o[1]),o})),xyMinMax:a}}};function v(n,t,o,r){var a=o.getAxis(["x","y"][n]),i=l(e([0,1],(function(n){return t?a.coordToData(a.toLocalCoord(r[n]),!0):a.toGlobalCoord(a.dataToCoord(r[n]))}))),s=[];return s[n]=i,s[1-n]=[NaN,NaN],{values:i,xyMinMax:s}}var M={lineX:n(m,0),lineY:n(m,1),rect:function(n,e,t){return[[n[0][0]-t[0]*e[0][0],n[0][1]-t[0]*e[0][1]],[n[1][0]-t[1]*e[1][0],n[1][1]-t[1]*e[1][1]]]},polygon:function(n,t,o){return e(n,(function(n,e){return[n[0]-o[0]*t[e][0],n[1]-o[1]*t[e][1]]}))}};function m(n,e,t,o){return[e[0]-o[n]*t[0],e[1]-o[n]*t[1]]}function T(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var I=f,S=function(){},R={};function A(n,e){R[n]=e}function N(n){return R[n]}export{I as B,S as T,N as g,A as r};
